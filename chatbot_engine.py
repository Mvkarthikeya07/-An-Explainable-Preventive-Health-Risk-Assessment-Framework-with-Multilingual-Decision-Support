def get_bot_response(message, risk_level=None, lang="en"):
    msg = message.lower()

    responses = {
        "en": {
            "greet": "Hello! ЁЯСЛ I'm your Health Assistant. How can I help you?",
            "diet": "A balanced diet with fruits, vegetables, whole grains, and low sugar is recommended.",
            "exercise": "Regular physical activity, at least 30 minutes a day, helps improve overall health.",
            "health": "To improve your health, focus on good nutrition, regular exercise, proper sleep, and stress management.",
            "risk": f"Your health risk level is {risk_level}." if risk_level else "Health risk depends on lifestyle and medical factors."
        },
        "hi": {
            "greet": "рдирдорд╕реНрддреЗ! ЁЯСЛ рдореИрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕рд╣рд╛рдпрдХ рд╣реВрдБред",
            "diet": "рдлрд▓, рд╕рдмреНрдЬрд╝рд┐рдпрд╛рдБ рдФрд░ рдХрдо рдЪреАрдиреА рд╡рд╛рд▓рд╛ рд╕рдВрддреБрд▓рд┐рдд рдЖрд╣рд╛рд░ рдЬрд╝рд░реВрд░реА рд╣реИред",
            "exercise": "рдирд┐рдпрдорд┐рдд рд╡реНрдпрд╛рдпрд╛рдо рд╕реНрд╡рд╛рд╕реНрдереНрдп рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рддрд╛ рд╣реИред",
            "health": "рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реБрдзрд╛рд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рднреЛрдЬрди, рд╡реНрдпрд╛рдпрд╛рдо, рдиреАрдВрдж рдФрд░ рддрдирд╛рд╡ рдирд┐рдпрдВрддреНрд░рдг рдЬрд╝рд░реВрд░реА рд╣реИред",
            "risk": f"рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдЬреЛрдЦрд┐рдо рд╕реНрддрд░ {risk_level} рд╣реИред" if risk_level else "рд╕реНрд╡рд╛рд╕реНрдереНрдп рдЬреЛрдЦрд┐рдо рдЬреАрд╡рдирд╢реИрд▓реА рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред"
        },
        "te": {
            "greet": "р░ир░ор░╕р▒Нр░Хр░╛р░░р░В! ЁЯСЛ р░ир▒Зр░ир▒Б р░ор▒А р░Жр░░р▒Лр░Чр▒Нр░п р░╕р░╣р░╛р░пр░Хр▒Бр░бр░┐р░ир░┐.",
            "diet": "р░кр░Вр░бр▒Нр░▓р▒Б, р░Хр▒Вр░░р░Чр░╛р░пр░▓р░др▒Л р░Хр▒Вр░бр░┐р░и р░╕р░ор░др▒Бр░▓ р░Жр░╣р░╛р░░р░В р░Ер░╡р░╕р░░р░В.",
            "exercise": "р░ир░┐р░др▒Нр░п р░╡р▒Нр░пр░╛р░пр░╛р░ор░В р░Жр░░р▒Лр░Чр▒Нр░пр░╛р░ир▒Нр░ир░┐ р░ор▒Жр░░р▒Бр░Чр▒Бр░кр░░р▒Бр░╕р▒Нр░др▒Бр░Вр░жр░┐.",
            "health": "р░Жр░░р▒Лр░Чр▒Нр░пр░В р░ор▒Жр░░р▒Бр░Чр▒Бр░кр░бр░╛р░▓р░Вр░Яр▒З р░╕р░░р▒Ир░и р░Жр░╣р░╛р░░р░В, р░╡р▒Нр░пр░╛р░пр░╛р░ор░В, р░ир░┐р░жр▒Нр░░ р░Ер░╡р░╕р░░р░В.",
            "risk": f"р░ор▒А р░Жр░░р▒Лр░Чр▒Нр░п р░кр▒Нр░░р░ор░╛р░ж р░╕р▒Нр░ер░╛р░пр░┐ {risk_level}." if risk_level else "р░Жр░░р▒Лр░Чр▒Нр░п р░кр▒Нр░░р░ор░╛р░жр░В р░Ьр▒Ар░╡р░ир░╢р▒Ир░▓р░┐р░кр▒И р░Жр░зр░╛р░░р░кр░бр░┐ р░Йр░Вр░Яр▒Бр░Вр░жр░┐."
        },
        "ta": {
            "greet": "ро╡рогроХрпНроХроорпН! ЁЯСЛ роиро╛ройрпН роЙроЩрпНроХро│рпН роЪрпБроХро╛родро╛ро░ роЙродро╡ро┐ропро╛ро│ро░рпН.",
            "diet": "рокро┤роЩрпНроХро│рпН рооро▒рпНро▒рпБроорпН роХро╛ропрпНроХро▒ро┐роХро│рпБроЯройрпН роЪроороиро┐ро▓рпИ роЙрогро╡рпБ роЕро╡роЪро┐ропроорпН.",
            "exercise": "родро┐ройроЪро░ро┐ роЙроЯро▒рпНрокропро┐ро▒рпНроЪро┐ роЙроЯро▓рпН роиро▓родрпНродрпИ роорпЗроорпНрокроЯрпБродрпНродрпБроорпН.",
            "health": "роЙроЯро▓рпН роиро▓родрпНродрпИ роорпЗроорпНрокроЯрпБродрпНрод роиро▓рпНро▓ роЙрогро╡рпБ, роЙроЯро▒рпНрокропро┐ро▒рпНроЪро┐ рооро▒рпНро▒рпБроорпН роУропрпНро╡рпБ родрпЗро╡рпИ.",
            "risk": f"роЙроЩрпНроХро│рпН роЪрпБроХро╛родро╛ро░ роЕрокро╛роп роиро┐ро▓рпИ {risk_level}." if risk_level else "роЪрпБроХро╛родро╛ро░ роЕрокро╛ропроорпН ро╡ро╛ро┤рпНроХрпНроХрпИ роорпБро▒рпИропрпИрокрпН рокрпКро▒рпБродрпНродродрпБ."
        },
        "ml": {
            "greet": "р┤ир┤ор┤╕р╡Нр┤Хр┤╛р┤░р┤В! ЁЯСЛ р┤Юр┤╛р╡╗ р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Бр┤Яр╡Ж р┤Жр┤░р╡Лр┤Чр╡Нр┤п р┤╕р┤╣р┤╛р┤пр┤┐ р┤Жр┤гр╡Н.",
            "diet": "р┤лр┤▓р┤Щр╡Нр┤Щр┤│р╡Бр┤В р┤кр┤Ър╡Нр┤Ър┤Хр╡Нр┤Хр┤▒р┤┐р┤Хр┤│р╡Бр┤В р┤Ер┤Яр┤Щр╡Нр┤Щр┤┐р┤п р┤╕р┤ор┤др╡Бр┤▓р┤┐р┤д р┤Жр┤╣р┤╛р┤░р┤В р┤Жр┤╡р┤╢р╡Нр┤пр┤ор┤╛р┤гр╡Н.",
            "exercise": "р┤жр╡Ир┤ир┤Вр┤жр┤┐р┤и р┤╡р╡Нр┤пр┤╛р┤пр┤╛р┤ор┤В р┤Жр┤░р╡Лр┤Чр╡Нр┤пр┤др╡Нр┤др╡Ж р┤ор╡Жр┤Ър╡Нр┤Ър┤кр╡Нр┤кр╡Жр┤Яр╡Бр┤др╡Нр┤др╡Бр┤В.",
            "health": "р┤Жр┤░р╡Лр┤Чр╡Нр┤пр┤В р┤ор╡Жр┤Ър╡Нр┤Ър┤кр╡Нр┤кр╡Жр┤Яр╡Бр┤др╡Нр┤др┤╛р╡╗ р┤╢р┤░р┤┐р┤пр┤╛р┤п р┤нр┤Хр╡Нр┤╖р┤гр┤╡р╡Бр┤В р┤╡р╡Нр┤пр┤╛р┤пр┤╛р┤ор┤╡р╡Бр┤В р┤╡р┤┐р┤╢р╡Нр┤░р┤ор┤╡р╡Бр┤В р┤Жр┤╡р┤╢р╡Нр┤пр┤ор┤╛р┤гр╡Н.",
            "risk": f"р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Бр┤Яр╡Ж р┤Жр┤░р╡Лр┤Чр╡Нр┤п р┤Ер┤кр┤Хр┤Я р┤ир┤┐р┤▓ {risk_level}." if risk_level else "р┤Жр┤░р╡Лр┤Чр╡Нр┤п р┤Ер┤кр┤Хр┤Яр┤В р┤Ьр╡Ар┤╡р┤┐р┤др┤╢р╡Ир┤▓р┤┐р┤пр╡Ж р┤Жр┤╢р╡Нр┤░р┤пр┤┐р┤Ър╡Нр┤Ър┤┐р┤░р┤┐р┤Хр╡Нр┤Хр╡Бр┤ир╡Нр┤ир╡Б."
        }
    }

    lang_data = responses.get(lang, responses["en"])

    # ЁЯФН INTENT DETECTION (IMPROVED)
    if any(word in msg for word in ["hi", "hello", "hey"]):
        return lang_data["greet"]

    if any(word in msg for word in ["diet", "food", "eat"]):
        return lang_data["diet"]

    if any(word in msg for word in ["exercise", "workout", "fitness"]):
        return lang_data["exercise"]

    if any(word in msg for word in ["health", "healthy", "improve"]):
        return lang_data["health"]

    if "risk" in msg:
        return lang_data["risk"]

    # DEFAULT RESPONSE
    return lang_data["health"]
