<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ t.result }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<div class="result-box">
    <h2>{{ t.result }}</h2>

    <div class="risk">
        {{ risk }}
    </div>

    <p>{{ advice }}</p>

    <!-- тЬЕ FIXED BUTTON LAYOUT -->
    <div class="action-buttons">
        <button type="button" class="btn" onclick="speakResult()">
            ЁЯФК Hear Result
        </button>

        <a href="/assessment" class="btn">
            ЁЯФБ Start Assessment
        </a>

        <a href="/chatbot" class="btn">
            ЁЯТм Talk to Health Assistant
        </a>
    </div>
</div>

<script>
const lang = "{{ session.get('lang','en') }}";

const resultVoices = {
    en: {
        low: "Your health risk level is low.",
        moderate: "Your health risk level is moderate.",
        high: "Your health risk level is high."
    },
    hi: {
        low: "рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдЬреЛрдЦрд┐рдо рд╕реНрддрд░ рдХрдо рд╣реИред",
        moderate: "рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдЬреЛрдЦрд┐рдо рд╕реНрддрд░ рдордзреНрдпрдо рд╣реИред",
        high: "рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдЬреЛрдЦрд┐рдо рд╕реНрддрд░ рдЕрдзрд┐рдХ рд╣реИред"
    },
    te: {
        low: "р░ор▒А р░Жр░░р▒Лр░Чр▒Нр░п р░кр▒Нр░░р░ор░╛р░ж р░╕р▒Нр░ер░╛р░пр░┐ р░др░Хр▒Нр░Хр▒Бр░╡р░Чр░╛ р░Йр░Вр░жр░┐.",
        moderate: "р░ор▒А р░Жр░░р▒Лр░Чр▒Нр░п р░кр▒Нр░░р░ор░╛р░ж р░╕р▒Нр░ер░╛р░пр░┐ р░ор░зр▒Нр░пр░╕р▒Нр░ер░Вр░Чр░╛ р░Йр░Вр░жр░┐.",
        high: "р░ор▒А р░Жр░░р▒Лр░Чр▒Нр░п р░кр▒Нр░░р░ор░╛р░ж р░╕р▒Нр░ер░╛р░пр░┐ р░Ор░Хр▒Нр░Хр▒Бр░╡р░Чр░╛ р░Йр░Вр░жр░┐."
    },
    ta: {
        low: "роЙроЩрпНроХро│рпН роЪрпБроХро╛родро╛ро░ роЕрокро╛роп роиро┐ро▓рпИ роХрпБро▒рпИро╡ро╛роХ роЙро│рпНро│родрпБ.",
        moderate: "роЙроЩрпНроХро│рпН роЪрпБроХро╛родро╛ро░ роЕрокро╛роп роиро┐ро▓рпИ роироЯрпБродрпНродро░рооро╛роХ роЙро│рпНро│родрпБ.",
        high: "роЙроЩрпНроХро│рпН роЪрпБроХро╛родро╛ро░ роЕрокро╛роп роиро┐ро▓рпИ роЕродро┐роХрооро╛роХ роЙро│рпНро│родрпБ."
    },
    ml: {
        low: "р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Бр┤Яр╡Ж р┤Жр┤░р╡Лр┤Чр╡Нр┤п р┤Ер┤кр┤Хр┤Я р┤ир┤┐р┤▓ р┤Хр╡Бр┤▒р┤╡р┤╛р┤гр╡Н.",
        moderate: "р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Бр┤Яр╡Ж р┤Жр┤░р╡Лр┤Чр╡Нр┤п р┤Ер┤кр┤Хр┤Я р┤ир┤┐р┤▓ р┤ор┤┐р┤др┤ор┤╛р┤гр╡Н.",
        high: "р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Бр┤Яр╡Ж р┤Жр┤░р╡Лр┤Чр╡Нр┤п р┤Ер┤кр┤Хр┤Я р┤ир┤┐р┤▓ р┤Хр╡Вр┤Яр╡Бр┤др┤▓р┤╛р┤гр╡Н."
    }
};

function speakResult() {
    window.speechSynthesis.cancel();

    const riskText = "{{ risk }}".toLowerCase();
    let level = "low";
    if (riskText.includes("moderate")) level = "moderate";
    else if (riskText.includes("high")) level = "high";

    const msg =
        (resultVoices[lang] && resultVoices[lang][level]) ||
        resultVoices["en"][level];

    const utterance = new SpeechSynthesisUtterance(msg);
    utterance.lang = lang + "-IN";
    speechSynthesis.speak(utterance);
}

window.onload = speakResult;
</script>

</body>
</html>
